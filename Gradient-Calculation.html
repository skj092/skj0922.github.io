<!DOCTYPE html>
<html lang="en">
    <head>
        <link href='//fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,400italic' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" type="text/css" href="/theme/stylesheet/style.min.css">
        <link rel="stylesheet" type="text/css" href="/theme/pygments/github.min.css">
        <link rel="stylesheet" type="text/css" href="/theme/font-awesome/css/font-awesome.min.css">
        <link href="/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Another data science student's blog Atom">
        <link href="/feeds/all.rss.xml" type="application/rss+xml" rel="alternate" title="Another data science student's blog RSS">
      
      
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="HandheldFriendly" content="True" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="robots" content="" />
      
      
        <meta name="author" content="Sonu Jha" />
        <meta name="description" content="" />
        <meta property="og:site_name" content="Another data science student's blog"/>
        <meta property="og:type" content="blog"/>
        <meta property="og:title" content="Another data science student's blog"/>
        <meta property="og:description" content=""/>
        <meta property="og:locale" content="en_US"/>
        <meta property="og:url" content=""/>
        <meta property="og:image" content="/images/profile.jpg">
      
        <title>Another data science student's blog </title>
    </head>
    <body>
        <aside>
            <div>
                <a href="https://skj092.github.io">
                <img src="/images/profile.png" alt="Sonu Jha" title="Sonu Jha">
                </a>
                <h1><a href="https://skj092.github.io">Sonu Jha</a></h1>
            <nav>
                <ul class="list">
                  <li><a href="/pages/about-me.html#about-me">About Me</a></li>
                </ul>
            </nav>
            <ul class="social">
                <li><a class="sc-linkedin" href="https://www.linkedin.com/in/sonu-jha-15022916b/" target="_blank"><i class="fa fa-linkedin"></i></a></li>
                <li><a class="sc-github" href="https://github.com/skj092" target="_blank"><i class="fa fa-github"></i></a></li>
                <li><a class="sc-twitter" href="https://twitter.com/Sonu_Kumar_Jha" target="_blank"><i class="fa fa-twitter"></i></a></li>
            </ul>
            </div>
        </aside>
        <main>
        <nav>
            <a href="https://skj092.github.io">    Home
        </a>
            <a href="/feeds/all.atom.xml">    Atom
        </a>
            <a href="/feeds/all.rss.xml">    RSS
        </a>
        </nav>

        <article class="single">
            <header>
              <h1 id="Gradient-Calculation">Gradient Calculation</h1>
              <p>Being a mathematics student I've always been curious to know how pytorch calculate 
                derivative of different kind of functions. In this blog I'll take different types 
                of functions and explain how to calculate gradient or derivative using pytorch.</p>
            </header>
          
            <div>
              <p>
                Depending on the input and output dimensional we can classify function into four types. 
                <ul>
                    <li>A function who take one dimensional input and produce one dimensional output.
                    <li>A function who take one dimensional input and produce multi dimensional output.
                    <li>A function who take multi dimensional input and produce one dimensional output.
                    <li>A function who take multi dimensional input and produce multi dimensional output.
                </ul>
                Mathematically these functions can be represented as follows:
            </p>
            <div class = 'math'>
                \begin{align*}
                    &f\colon R  \longrightarrow R\\
                     &f\colon R  \longrightarrow R^n\\
                      &f\colon R^n \longrightarrow R\\
                       &f\colon R^n \longrightarrow R^n\\
                \end{align*}
                <p>Here R represent real number and m and n are integers with value greater then 1. </p>
                </div>
          <img alt="torch" class="align-left" src="../images/1.png" />


          <div class="section" id="Gradient-Calculation">
            <h2>Lets Try to calculate derivative of these function.<h2>
                <h3>1. Function with one dimensional input and one dimensional output.</h3>
                <img alt="f1" class="align-left" src="../images/2.png" />

            <p>We can also define x using Variable function and perform same operation as below.</p>
                <img alt="f1" class="align-left" src="../images/3.png"  />
                <hp>Here we defined a function<p>
                    <div class="math">
                    \begin{align*}
                    &f\colon R \longrightarrow R\\
                    &\ni \forall x \in R\\
                        &f = x^4\\
                         &\therefore df = f.backward() = \frac{df}{dx} = 4*x^3\\
                          &\therefore x.grad = \frac{df}{dx}_{x=2} =4*2^3 = 32
                    \end{align*}
                    </div>
    <h3>2. Function with multi dimensional input and one dimensional output.</h3>
    <img alt="f1" class="align-left" src="../images/4.png" />


    <p>Here </p>
<div class = 'math'>
\begin{align*}
    &f\colon R^2 \longrightarrow R\\
     &\ni \forall  x = \left(x_{1},x_{2}\right) \in R^2\\
      &f = x_{1}^2+x_{2}^2\\
       &\therefore df = f.backward() = \frac{df}{dx} = \left(\frac {df}{dx_1},\frac{df}{dx_2}\right)\\
         &\because\frac{df}{dx_1} = 2*x_1 \\
           &\frac{df}{dx_2} = 2*x_2\\
             &\therefore{df} = \left(2x_1,2x_2\right)\\
               &\therefore x.grad = \frac{df}{dx}_{x=\left(5,4\right)} = \left(2*5,2*4\right) = (10,8)  
\end{align*}

<h3>3. Function with one dimensional input and multi dimensional output.</h3>
<h4>These types of function also called as vector valued function.</h4>
<img alt="f1" class="align-left" src="../images/5.png" />
<p>Here</p>
<div class = 'math'>
\begin{align*}
    &f\colon R \longrightarrow R^2\\
     &\ni \forall  x \in R\\
      &f(x) = (x^2,x^3) = x^2i+x^3j\\
       &df = f.backward() = \frac{df}{dx} = 2xi+3x^2j\\
        &\therefore x.grad =  \frac{df}{dx}_{x=4} = (2*4)i+(3*4^2)j = 8+48 = 56
\end{align*}

<h3>4. Function with multi dimensional input and multi dimensional output.</h3>
<img alt="f1" class="align-left" src="../images/6.png" />
<div class = 'math'>
    \begin{align*}
        &f\colon R^2 \longrightarrow R^3\\
         &\ni \forall  x = \left(x_{1},x_{2}\right) \in R^2\\
          &f(x) = \left(x_1^2,x_2^3,x_2^4\right)\\
           &df = f.backward() = \frac{df}{dx} = \left(\frac {df}{dx_1},\frac{df}{dx_2}\right)\\
            &\because\frac{df}{dx_1} = 2x_1 \\
             &\frac{df}{dx_2} = 3x_2^2+4x_2^3\\
              &\therefore df = \left(2x_1,3x_2^2+4x_2^3\right)\\
               &\therefore x.grad =  \frac{df}{dx}_{x=(2,2)} = (2*2,3*2^2+4*2^3) = (4,44)
    \end{align*}  
    </div>

    <h3>Conclustion: </h3>
        <p>We have studied how to calculate gradient of functions with different input and output dimensions.</p>
            <h4>Reference Links:</h4>
            <p><a href="https://pytorch.org/">Pytorch Official documentation </a></p>
            <p><a href="https://medium.com/@zhang_yang/gradient-calculation-examples-in-pytorch-bffe287d8634">Medium Article</a></p>



</div>

<script type='text/javascript'>if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width < 768) ? "left" : align;
        indent = (screen.width < 768) ? "0em" : indent;
        linebreak = (screen.width < 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>
  </div>




</article>

        <footer>
<p>&copy; Sonu Jha </p>
<p>Powered by <a href="http://getpelican.com" target="_blank">Pelican</a> -
    <a href="https://github.com/alexandrevicenzi/flex" target="_blank">Flex</a>
    theme by <a href="http://alexandrevicenzi.com" target="_blank">Alexandre Vicenzi</a>
</p>    </footer>
  </main>


<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Another data science student's blog ",
  "url" : "",
  "image": "/images/profile.jpg",
  "description": ""
}
</script>
</body>
</html>